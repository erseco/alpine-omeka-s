<?xml version="1.0" encoding="UTF-8"?>
<policymap>
  <!-- Resource limits: tune for your container -->
  <policy domain="resource" name="memory" value="512MiB"/>
  <policy domain="resource" name="map"    value="1GiB"/>
  <policy domain="resource" name="area"   value="512MiB"/>
  <policy domain="resource" name="disk"   value="1GiB"/>
  <policy domain="resource" name="width"  value="8000"/>
  <policy domain="resource" name="height" value="8000"/>
  <policy domain="resource" name="time"   value="120"/>

  <!-- Deny-all first -->
  <policy domain="delegate" rights="none" pattern="*"/>
  <policy domain="filter"   rights="none" pattern="*"/>
  <policy domain="coder"    rights="none" pattern="*"/>

  <!-- No remote reads and no @file indirection -->
  <policy domain="coder" rights="none" pattern="URL"/>
  <policy domain="coder" rights="none" pattern="HTTP"/>
  <policy domain="coder" rights="none" pattern="HTTPS"/>
  <policy domain="path"  rights="none" pattern="@*"/>

  <!-- Block risky vector and PostScript families -->
  <policy domain="coder" rights="none" pattern="MVG"/>
  <policy domain="coder" rights="none" pattern="MSL"/>
  <policy domain="coder" rights="none" pattern="PS"/>
  <policy domain="coder" rights="none" pattern="PS2"/>
  <policy domain="coder" rights="none" pattern="PS3"/>
  <policy domain="coder" rights="none" pattern="EPS"/>
  <policy domain="coder" rights="none" pattern="XPS"/>

  <!-- Whitelist common web image formats -->
  <policy domain="coder" rights="read|write" pattern="JPEG"/>
  <policy domain="coder" rights="read|write" pattern="PNG"/>
  <policy domain="coder" rights="read|write" pattern="WEBP"/>
  <policy domain="coder" rights="read|write" pattern="GIF"/>

  <!-- PDF thumbnails: allow read to generate images from PDFs -->
  <policy domain="coder" rights="read" pattern="PDF"/>
</policymap>
